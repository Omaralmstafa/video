# شرح ملف admin.py

## الموقع
`video_share/admin.py`

## الوظيفة
يحدد كيفية عرض وإدارة نماذج قاعدة البيانات في لوحة إدارة Django.

---

## شرح الكود

### 1. الاستيرادات
```python
from django.contrib import admin
from .models import Video
```

- **admin**: لوحة إدارة Django
- **Video**: النموذج الذي نريد إدارته

---

### 2. تسجيل النموذج
```python
@admin.register(Video)
class VideoAdmin(admin.ModelAdmin):
```

**الشرح:**
- `@admin.register(Video)`: ديكوراتور لتسجيل النموذج
- `VideoAdmin`: كلاس يحدد كيفية عرض Video في لوحة الإدارة
- `ModelAdmin`: كلاس أساسي من Django

**بديل:**
```python
# يمكن استخدام هذا بدلاً من @admin.register
admin.site.register(Video, VideoAdmin)
```

---

### 3. الحقول المعروضة في القائمة (list_display)
```python
list_display = ('title', 'uploaded_at', 'views', 'likes', 'is_published')
```

**الوظيفة:**
- يحدد الأعمدة المعروضة في قائمة الفيديوهات
- الترتيب: من اليسار لليمين

**النتيجة في لوحة الإدارة:**
```
| العنوان | تاريخ التحميل | المشاهدات | الإعجابات | منشور |
|---------|---------------|-----------|----------|-------|
| فيديو 1 | 2024-01-15    | 150       | 25       | ✓     |
| فيديو 2 | 2024-01-14    | 200       | 30       | ✓     |
```

---

### 4. الفلاتر (list_filter)
```python
list_filter = ('is_published', 'uploaded_at')
```

**الوظيفة:**
- يضيف قوائم تصفية على الجانب الأيمن
- يساعد في البحث والتصفية السريعة

**النتيجة:**
- فلتر حسب `is_published`: (منشور / غير منشور)
- فلتر حسب `uploaded_at`: (اليوم / هذا الأسبوع / هذا الشهر)

---

### 5. حقول البحث (search_fields)
```python
search_fields = ('title', 'description')
```

**الوظيفة:**
- يضيف صندوق بحث في أعلى القائمة
- يبحث في الحقول المحددة

**الاستخدام:**
- اكتب في صندوق البحث: "رائع"
- Django يبحث في `title` و `description`

---

### 6. الحقول للقراءة فقط (readonly_fields)
```python
readonly_fields = ('views', 'likes', 'uploaded_at', 'updated_at')
```

**الوظيفة:**
- هذه الحقول تظهر في صفحة التعديل لكن لا يمكن تعديلها
- مفيد للحقول التي تُحدث تلقائياً

**لماذا؟**
- `views`, `likes`: تُحدث تلقائياً من الكود
- `uploaded_at`, `updated_at`: تُحدث تلقائياً من Django

---

### 7. تجميع الحقول (fieldsets)
```python
fieldsets = (
    ('معلومات الفيديو', {
        'fields': ('title', 'description', 'file', 'thumbnail')
    }),
    ('الإحصائيات', {
        'fields': ('views', 'likes', 'uploaded_at', 'updated_at')
    }),
    ('الحالة', {
        'fields': ('is_published',)
    }),
)
```

**الوظيفة:**
- يقسم الحقول إلى مجموعات في صفحة التعديل
- يجعل الواجهة أكثر تنظيماً

**النتيجة في صفحة التعديل:**
```
┌─────────────────────────┐
│ معلومات الفيديو        │
│ - العنوان              │
│ - الوصف                │
│ - ملف الفيديو          │
│ - الصورة المصغرة       │
└─────────────────────────┘

┌─────────────────────────┐
│ الإحصائيات             │
│ - المشاهدات (للقراءة)  │
│ - الإعجابات (للقراءة)  │
│ - تاريخ التحميل        │
│ - تاريخ التحديث        │
└─────────────────────────┘

┌─────────────────────────┐
│ الحالة                  │
│ - منشور                 │
└─────────────────────────┘
```

---

## كيفية الوصول للوحة الإدارة

### 1. إنشاء مستخدم إداري
```bash
python manage.py createsuperuser
```

**المطلوب:**
- اسم المستخدم
- البريد الإلكتروني (اختياري)
- كلمة المرور

### 2. الوصول
```
http://127.0.0.1:8000/admin/
```

### 3. تسجيل الدخول
- استخدم اسم المستخدم وكلمة المرور

---

## الميزات المتاحة في لوحة الإدارة

### 1. عرض القائمة
- جميع الفيديوهات في جدول
- يمكن التصفية والبحث
- يمكن الترتيب بالنقر على رأس العمود

### 2. إضافة فيديو جديد
- زر "إضافة فيديو" في أعلى القائمة
- نموذج لإدخال البيانات
- رفع ملف الفيديو

### 3. تعديل فيديو
- انقر على فيديو من القائمة
- عدّل الحقول
- احفظ التغييرات

### 4. حذف فيديو
- اختر فيديو (checkbox)
- اختر "حذف" من القائمة المنسدلة
- تأكيد الحذف

---

## تخصيصات إضافية (اختيارية)

### إضافة أعمدة مخصصة
```python
class VideoAdmin(admin.ModelAdmin):
    list_display = ('title', 'uploaded_at', 'views', 'likes', 'is_published', 'custom_field')
    
    def custom_field(self, obj):
        return f"{obj.views} مشاهدة"
    custom_field.short_description = 'مشاهدات'
```

### إضافة إجراءات مخصصة
```python
class VideoAdmin(admin.ModelAdmin):
    actions = ['make_published', 'make_unpublished']
    
    def make_published(self, request, queryset):
        queryset.update(is_published=True)
    make_published.short_description = 'نشر الفيديوهات المحددة'
    
    def make_unpublished(self, request, queryset):
        queryset.update(is_published=False)
    make_unpublished.short_description = 'إلغاء نشر الفيديوهات المحددة'
```

### تخصيص صفحة التعديل
```python
class VideoAdmin(admin.ModelAdmin):
    fields = ('title', 'description', 'file')  # ترتيب الحقول
    readonly_fields = ('views', 'likes')
    
    # إضافة مساعدة
    def get_form(self, request, obj=None, **kwargs):
        form = super().get_form(request, obj, **kwargs)
        form.base_fields['title'].help_text = 'أدخل عنوان واضح للفيديو'
        return form
```

---

## أمثلة على الاستخدام

### مثال 1: البحث عن فيديو
1. اذهب إلى `/admin/`
2. اختر "فيديوهات"
3. اكتب في صندوق البحث: "رائع"
4. Django يعرض الفيديوهات التي تحتوي "رائع" في العنوان أو الوصف

### مثال 2: تصفية الفيديوهات
1. في قائمة الفيديوهات
2. استخدم الفلتر "منشور" → اختر "نعم"
3. Django يعرض الفيديوهات المنشورة فقط

### مثال 3: تعديل فيديو
1. انقر على فيديو من القائمة
2. عدّل العنوان أو الوصف
3. انقر "حفظ"
4. التغييرات تُطبق فوراً

---

## ملاحظات مهمة

1. **الأمان**: لوحة الإدارة محمية بكلمة مرور
2. **الصلاحيات**: يمكن إنشاء مستخدمين بصلاحيات مختلفة
3. **التخصيص**: يمكن تخصيص كل شيء في لوحة الإدارة
4. **الأداء**: استخدم `list_select_related` لتحسين الأداء مع العلاقات

---

## نصائح للاستخدام

1. **استخدم الفلاتر**: لتسهيل البحث في قوائم طويلة
2. **استخدم البحث**: للعثور على فيديو محدد بسرعة
3. **استخدم الإجراءات**: لتعديل عدة فيديوهات دفعة واحدة
4. **راجع الإحصائيات**: لمراقبة المشاهدات والإعجابات

